02.Win32 API简介

我只是想复制从DirectX 9创建一个窗口的课程，因为他们是相同的。这里有很多代码可以开始使用。
但是一旦我们再这里完成，我们就可以开始实际应用DirectX了。

我们的应用程序首先要包含windows.h头文件。当你创建一个窗口的时候，你需要为该窗口创建
windows类。这就是下一行的用途。下边就是我们的窗口。

```c++
#include <windows.h>

LPCTSTR WndClassName = "firstwindow";
HWND hwnd = NULL;
```

我们将使用这些常量来定义窗口的大小。

```c++
const int Width=800
const int Height=600
```

initializeWindow()函数将执行它所说的内容。然后根据窗口是否成功，返回true或者是false。
然后我们初始化消息循环函数，这是使程序保持运行的函数。我们稍后会介绍这些内容。

```C++
bool InitializeWindow(HINSTANCE hInstance,
         int ShowWnd,
         int width, int height,
         bool windowed);

int messageloop();
```


我们初始化Windows回调的过程。Windows API是一个“事件驱动”的编程模型。因此在这个函数中，
我们可以“捕获”窗口消息，如按键（也叫做事件）并且操纵我们程序的流程。

```c++
LRESULT CALLBACK WndProc(HWND hWnd,
         UINT msg,
         WPARAM wParam,
         LPARAM lParam);
```

我们需要一个主函数来启动我们的应用程序，在Windows编程中，这个函数是WinMain（）函数。

```c++
int WINAPI WinMain(HINSTANCE hInstance,    //Main windows function
       HINSTANCE hPrevInstance, 
       LPSTR lpCmdLine,
       int nShowCmd)
{
```

我们再WinMain（）函数中做的第一件事件是通过调用initializewindow（）函数来创建和
注册我们的窗口。根据窗口是否已经注册和创建，该函数返回true或者是false。在窗口初始化
之后，我们将继续我们的应用程序的交互部分。消息循环。

再之后，我们跳进消息循环。当消息循环完成的时候，我们通过返回0来结束我们的程序，如果是
返回值为0，那么就表示程序没有问题。

```c++
int WINAPI WinMain(HINSTANCE hInstance,    //Main windows function
	HINSTANCE hPrevInstance,
	LPSTR lpCmdLine,
	int nShowCmd)
{
	if (!InitializeWindow(hInstance, nShowCmd, Width, Height, true))
	{
		MessageBox(0, "Window Initialization - Failed",
			"Error", MB_OK);
		return 0;
	}
	messageloop();
	return 0
}
```

我们的下一个函数是initialize Window（hlnstance，nshowcmd）函数。这将创建并且注册该类
HINSTANCE hlnstance-这是我们当前应用程序的句柄。

```c++
//应该如何显示窗口。一些常见的命令是SW_SHOWMAXIMIZED,SW_SHOW,SW_SHOWMINIMIZED
int ShowWnd - How the window should be displayed. Some common commands are SW_SHOWMAXIMIZED, SW_SHOW, SW_SHOWMINIMIZED.
//窗口的宽度
int width - Width of the window in pixels
//窗口的高度
int height - Height of the window in pixels
//如果窗口是全屏则为false，否则就是true
bool windowed - False if the window is fullscreen and true if the window is windowed


bool InitializeWindow(HINSTANCE hInstance,
         int ShowWnd,
         int width, int height,
         bool windowed)
{
```

我们接下来创建一个名为wc的拓展样式窗口类。然后填写所有属性。WNDCLASSESEX结果如下所示：

```c++
typedef struct _WNDCLASS {
    UINT cbSize;
    UINT style;
    WNDPROC lpfnWndProc;
    int cbClsExtra;
    int cbWndExtra;
    HANDLE hInstance;
    HICON hIcon;
    HCURSOR hCursor;
    HBRUSH hbrBackground;
    LPCTSTR lpszMenuName;
    LPCTSTR lpszClassName;
} WNDCLASS;

WNDCLASSEX wc;
```

第一个是UNIT cbSize。他应该设置为我们的窗口类的大小。sizeof(WNDCLASSEX)

```c++
wc.cbSize=sizeof(WNDCLASSEX);
```

style是windows类的样式。他都以CS_开头。这里有一些例子进行举出：

CS_CLASSDC 1 OK 按钮
CS_DBLCLKS 在使用此类创建的所有窗口之间共享一个设备上下文。
CS_HREDRAW 在窗口上启用双击鼠标。

如果想了解更多的style样式，点击原文中的连接。

当窗口移动或者改变大小的时候，我们只是将我们设置为重绘。

```c++
wc.style = CS_HREDRAW | CS_VREDRAW;
```
lpfnWndPRoc是指向我们想要处理Windows消息的函数的指针。他被设置为WndProc，因为这就是
我们的Windows处理功能的名称。

```c++
wc.lpfnWndProc=WndProc;
```

cbClsExtra是WNDCLASSEX之后分配的额外字节数

```c++
wc.cbClsExtra = NULL;
```

cbWindExtra指定在windows实例之后分配的字节数

```c++
wc.cbWndExtra = NULL;
```

这是我们当前windows应用程序的句柄。GetModuleHandle（）函数可以通过将UNLL传递给他的参数来获取
当前窗口应用程序。

```c++
wc.hInstance = hInstance;
```

hlcon用于指定标题栏中窗口左上角的图标。以下是一些标准的图标：

IDI_APPLICATION 默认的应用程序图标
IDI_HAND 手型图标
IDI_EXCLAMATION 感叹号图标
有关图标的更多信息，点击原文中的连接。

```
wc.hIcon = LoadIcon(NULL, IDI_APPLICATION);
```

接下来的这个内容定义了光标所在的图标。以下是一些标准的内容：

IDC_APPSTARTING 标准箭头和小沙漏光标。
IDC_ARROW  标准箭头光标。
IDC_CROSS 十字光标。
有关光标的更多信息，点击原文中的连接。

```c++
wc.hCursor = LoadCursor(NULL, IDC_ARROW);
```

hbrBackground是画笔的句柄。这将使得北京变黑。

```c++
wc.hbrBackground = (HBRUSH)(COLOR_WINDOW + 2);
```

接下来的这个变量内容是附加到窗口的菜单名称，我们没有，所以我们设定为NULL。

```c++
wc.lpszMenuName = NULL;
```

接下来是我们的类名

```c++
wc.lpszClassName=WndClassName;
```

接下来这个内容指定了任务栏中的图标，他的使用和上边相同的IDI图标

```c++
wc.hIconSm = LoadIcon(NULL, IDI_APPLICATION);
```

当所有样式（也可以理解为变量）的内容设定完毕之后，我们注册类。如果失败，我们将受到错误信息。
如果他没有问题，那么我们创建出窗口即可。

```c++
if (!RegisterClassEx(&wc))
{
    MessageBox(NULL, "Error registering class",    
        "Error", MB_OK | MB_ICONERROR);
    return false;
}
```

 类似于C++创建一个类的方式，我们可以将窗口创建出来
 
```c++
hwnd=CreatWindowEx(拓展的样式,
                   我们窗口将使用的类的名称,
                   将出现在标题栏中的文本)
```



