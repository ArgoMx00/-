

现在，我们河床已经准备好了。这实际上是最简单的部分；我们所做的只是遍历河流的每个
顶点，并且将某个半径内的所有高度图顶点降低到小于当前河顶点的高度。我们降低多少
取决于我们要去雕刻的河床的深度和长度。这种特殊的雕刻会留下一些尖锐的边缘，但是由于
河床边缘的锐利度已经相当小，并且可以通过地形高度上的双线性滤波器轻松平滑。就我们实际
的河流雕刻而言，这几乎就是这样。可以应用这些算法来创建不同的效果。我发现在我们的实现
中，它实际上是在相当平坦的地形上刻画了一些细节。

关于河床雕刻的另一个说明，因为我在每个河流节点上雕刻一个方形图案到高度图中，这不仅仅
会浪费时间，而且还会导致一些不可预估的后果。我为了解决这样一个问题做了一件事，那就是我
每一次经过的河流节点，当它沿着地图移动处理的时候，我都沿着床边平均出高度。我发现这在
雕刻河床时比处理速度快，因为它允许我在这两种情况下做出更多的假设，但是结果肯定还是一样的
随着河流的长度边长，深度的结果还是会随着变化的。

六、详细程度以及其他影响因素：

如果不是彻头彻尾的要求使用详细程度渲染地形，那么现在的做法就已经差不多足够了。
如果使用考虑地形崎岖的细节算法，在需要的地方提供更多的细节，比如ROAM算法，它
不会对河流产生太多的影响。如果我们使用的是更加简单的方法，例如：geomipmapping
我发现我们需要限制包含河流部分的修补程序的详细程度。在通常情况下，如果你不这样做
地形在当前补丁中就会被过度简化，完全消除了河流的任何明显迹象。根据您的相机角度以
及我们在世界各地移动的速度，这样也可能会成为问题。

七、Creating the Water

①创建水可能是一项相当棘手的任务，取决于我们是想让他流动还是上下移动，适应Lod还是仅仅
保持静态。流水的实际模拟超出了本文的范围，但是，我们将讨论一种非常简单的方法来模拟这
条新形成的河流的静态三角形条带。在实际的实现中，哦们可能要将它分解成每个地形补丁的不同
三角形条，并使其与当前的LOD相匹配。我们必须要做到的第一件事是认识到，尽管这是一条看似
随意的河流，但他仍然是一个靠着方法和算法构建出来的。如果我们始终从河流的一端开始穿过节
点列表，我们可以在我们穿过节点的时候从右侧和左侧交替出现三角形带中的每个需要的顶点，然
吼在这里真正的问题是我们如何找到他们的位子。

②首先我们先设计一些假设，我们将从河流的高端行驶到低端，然后我们将以右、左、右、左的顺时针
方式创建我们的三角形地带。为了计算特定顶点的方向，我们将使用一点线性代数，但是我们将能够
将它全部保留在二维空间中，这使得它更容易一些。如果我们想象从一条从我们现在的位子通过我们
现在的位子到我们要去的位子的线，我们将近似于我们当前的方向（水流向哪个方向）。当站在沿着
方向的河的中间的时候，河的宽段将会在我们的左右。换句话说，河流的宽度将垂直于我们的方向。
因此，为了找到当前位子的顶点位子，我们将沿垂直于我们方向的两个方向移出一半的河流宽度。
因为我们将整个过程简化为2D，所以我们可以很容易的将垂直线表示为具有我们当前线的负反斜率的
垂线。以下是一些实例代码，希望能够更好的解释该过程：


八、结论

将随机河流雕刻成随机地形并不是一件容易的事情，我们在这里提出的知识沃恩完成的这项任务的很多方法
之一。河流可以在其他常规地形中增加景观的每秒变化，同创会增加角色和深度。通过将这个想法分解成
更小的部分兵分析我们的目标是什么，我们就可以轻松的完成我们正在寻找的任务。本文没有描述创建河流
最快的方法，最好的方法，甚至是最现实的方法，而是我们提供了建立我们正在寻找的风格的良好基础。

以上文章内容，翻译自：http://archive.gamedev.net/archive/reference/articles/article2065.html










































