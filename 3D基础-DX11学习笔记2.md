4.1 准备工作

Direct3D的初始化过程要求我们熟悉一些基本的D3D类型和基本的绘图概念。本章节会介绍必要的基础知识。
然后我们会讲解D3D初始化过程中的每一个必要步骤。最后，我们将讨论一下示例框架代码，它是本书所有演示
程序使用的统一编程接口。

Direct3D是一种底层绘图API的接口。他可以让我们通过3D硬件加速绘制3D世界。从本质上来讲，D3D提供的
是一组软件接口，我们可以通过这组接口来控制绘图硬件。例如，我们要求命令绘图设备清空渲染目标，我们
可以调用D3D的ID3D11DeviceContext::ClearRenderTargetView方法来完成这个工作。D3D底层位于应用
程序和绘图硬件之间，这样我们就不必要担心3D硬件的实现细节了，只要设备支持D3D11，我们就可以通过
D3D 11API来控制3D硬件了。

COM，组件对象模型COM技术使DirectX独立于任何编程语言，并具有版本向后兼容的特性。我们经常把COM
称为接口，并且把他当成一个普通的C++类来使用。当使用C++编写DirectX程序的时候，许多COM的底层细节
不用考虑，唯一需要知道的一个事情是，我们必须通过特定的函数或者其他的COM接口方法来获取指向COM接口的
指针，而不能使用C++的New关键之来创建COM接口。
当然，有关COM的细节还有很多，但是实际工作中只需要知道上述内容就足以有效的使用DirectX了。
COM接口都以大写字母I为前缀，例如，表示2D纹理的接口为ID3D11Textrue2D

4.2 纹理和数据资源格式

2D纹理是一种数据元素矩阵。2D纹理的用途之一就是存储2D图像数据。在纹理的每个元素中存储一个像素的颜色。
但这不是纹理的唯一用途。例如，有一种称为法线贴图映射的高级技术在纹理元素中存储的不是颜色，而是3D向量。
因此，从通常意义上来讲，纹理用来存储图像数据，但是在实际应用中纹理可以有更加广泛的用途。1D纹理类似于
一个1D数据元素数组，3D纹理类似于一个3D数据元素数组。但是在随后的章节中会提到，纹理不仅仅是一个数据
数组，纹理可以带有多级渐进纹理层。GPU可以在纹理上执行特殊的运算，比如使用过滤器Filter和多重采样。
此外，不是任何类型的数据都能够存储到纹理中的，纹理只迟滞特定格式的数据存储。这些格式由DXGI_FROMAT
枚举类型描述，一些常用的格式如下：

![](https://i.loli.net/2019/01/15/5c3d63bfbed0c.png)

4.3其他相关内容的介绍

深度缓冲区是一个不包含图像数据的纹理对象。在一定程度上，深度信息可以被认为是一种特殊的像素。常见的深度值
范围在0.0到1.0之间。

纹理可以被绑定到渲染管线的不同阶段，例如，比较常见的情况是将纹理作为渲染目标，或者着色器资源。当创建用于
这两种目的的纹理资源的时候，应使用绑定的标志值。

多重采样：因为计算机显示器上的像素分辨率有限，所以当我们绘制一条任意的直线的时候，该直线很难精确地显示在屏幕上
也就是有明显的抗锯齿。通过提高显示器的分辨率，缩小像素的尺寸，也可以有效的解决这一问题。D3D支持另一种多重采样
的抗锯齿技术，它通过对一个像素的子像素进行采样计算出该像素的最终颜色，节省了资源。

特征等级：D3D提出了特征等级的概念，对应了定义了D3D11中定义了如下几个等级以代表不同的D3D版本：

![](https://i.loli.net/2019/01/15/5c3d65779679b.png)

特征等级定义了一系列支持不同d3d功能的相应的等级，用意即如果一个用户的硬件不支持某一特征等级，程序可以选择较低的
等级。

4.4对D3D进行初始化

D3D的初始化过程分为以下几个步骤：

①使用D3D11CreateDevice方法创建ID3D11Device和ID3D11DeviceContext

②使用ID3D11Device::CheckMultisampleQualityLevels方法检测设备支持的4X多重采样的质量等级。

③填充一个IDXGI_SWAP_CHAIN_DESC结构体，该结构体描述了所要创建的交换链的特性。

④查询IDXGIFactory实例，这个实例用于创建设备和一个IDXGISwapChain实例。

⑤为交换链的后台缓存区创建一个渲染目标视图。

⑥创建深度缓冲区以及相关的深度/模板视图

⑦将渲染目标视图和深度视图绑定到渲染管线的输出合并阶段。使他们可以被D3D使用。

⑧设置视口。

4.5计时器和动画

我们使用性能计时器来实现精确的时间测量。是为了使用用于查询性能计时器的Win32函数，我们必须在代码中包含语句#include <windows.h>

4.6演示程序框架





































